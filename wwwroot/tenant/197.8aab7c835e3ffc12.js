"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[197],{1197:(R,T,l)=>{l.r(T),l.d(T,{AuthModule:()=>$,HttpLoaderFactory:()=>N});var M=l(6019),p=l(9133),_=l(3009),d=l(8260),e=l(3668),f=l(9091),u=l(9861),S=l(1427);const C=function(){return["/"]};let m=(()=>{class t{constructor(n,i,o,r){this.route=n,this.router=i,this.authService=o,this.spinner=r,this.route.queryParams.subscribe(c=>{c.access_token&&this.signInByAccessToken(c.access_token)}),o.isLoggedIn&&this.router.navigateByUrl("/")}SignIn(n){this.spinner.show(),n.target.classList.add("disabled"),location.href=`${d.N.apiServer}/OAuth/SignIn?scheme=OpenAuth&client_id=${d.N.defaultSignInAppKey}&redirect_uri=${d.N.signinCallback}&scope=openid profile role permission&nonce=123456789&state=`}signInByAccessToken(n){this.spinner.show(),this.authService.loginByAccesstoken(n).add(()=>{if(this.spinner.hide(),this.authService.isLoggedIn){let i=this.authService.redirectUrl?this.router.parseUrl(this.authService.redirectUrl):"/";this.router.navigateByUrl(i,{queryParamsHandling:"preserve",preserveFragment:!0})}})}}return t.\u0275fac=function(n){return new(n||t)(e.Y36(_.gz),e.Y36(_.F0),e.Y36(f.e),e.Y36(u.t2))},t.\u0275cmp=e.Xpm({type:t,selectors:[["app-signin"]],decls:14,vars:2,consts:function(){let s,n;return s=$localize`:@@登录:登录`,n=$localize`:@@返回首页:返回首页`,[[1,"container-fluid"],[1,"row"],[1,"col-sm-12","col-md-4","offset-md-4","d-flex","align-items-center","justify-content-center",2,"height","100vh"],[1,"text-center","pb-5",2,"width","80%"],["src","./assets/app_default.png","width","68px",1,"border","p-1","rounded-circle","shadow"],[1,"mt-4","mb-2"],["type","button","translate","",1,"btn","btn-indigo",3,"click"],s,["translate","",1,"btn","btn-link","mx-2",3,"routerLink"],n,["size","default","color","#fff","type","ball-beat"]]},template:function(n,i){1&n&&(e.TgZ(0,"div",0),e.TgZ(1,"div",1),e.TgZ(2,"div",2),e.TgZ(3,"div",3),e.TgZ(4,"div"),e.TgZ(5,"div"),e._UZ(6,"img",4),e.qZA(),e.TgZ(7,"div",5),e.TgZ(8,"button",6),e.NdJ("click",function(r){return i.SignIn(r)}),e.SDv(9,7),e.qZA(),e.qZA(),e.qZA(),e._UZ(10,"hr"),e.TgZ(11,"a",8),e.SDv(12,9),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e._UZ(13,"ngx-spinner",10)),2&n&&(e.xp6(11),e.Q6J("routerLink",e.DdM(1,C)))},directives:[S.Pi,_.yS,u.Ro],styles:[""]}),t})(),h=(()=>{class t{constructor(n,i,o){this.router=n,this.route=i,this.authService=o,this.router.queryParams.subscribe(r=>{r.access_token?(r.state&&(this.authService.redirectUrl=r.state),this.route.navigateByUrl(`/auth/signin?access_token=${r.access_token}`)):this.route.navigateByUrl("/")})}}return t.\u0275fac=function(n){return new(n||t)(e.Y36(_.gz),e.Y36(_.F0),e.Y36(f.e))},t.\u0275cmp=e.Xpm({type:t,selectors:[["app-signin-callback"]],decls:1,vars:0,consts:[["size","default","color","#fff","type","ball-beat"]],template:function(n,i){1&n&&e._UZ(0,"ngx-spinner",0)},directives:[u.Ro],styles:[""]}),t})();var P=l(8239),a=l(6588),U=l(2666),E=l(7732);const Z=function(){return["/"]},v=[{path:"",redirectTo:"signin"},{path:"signin",component:m},{path:"signup",component:(()=>{class t{constructor(n,i,o){this.serv=n,this.spinner=i,this.router=o,this.item={avatar:d.N.defaultUserIcon,phone:"",email:"",pwd:""}}ngOnInit(){}signin(){var n=this;return(0,P.Z)(function*(){/^([a-zA-Z\d])(\w|\-)+@[a-zA-Z\d]+\.[a-zA-Z]{2,4}$/g.test(n.item.email)?/^[a-zA-Z0-9]{6,12}$/g.test(n.item.pwd)?n.item.pwd==n.pwd2?/^[0-9]{6,30}$/g.test(n.item.phone)?!(yield a.R.fire({icon:"question",title:"\u662f\u5426\u786e\u8ba4\u6ce8\u518c\uff1f",showCancelButton:!0})).isConfirmed||(n.spinner.show(),n.serv.UserSignUp(n.item).subscribe(o=>{n.spinner.hide(),200==o.code?(a.F.fire({icon:"success",titleText:"\u6ce8\u518c\u6210\u529f\uff0c\u8bf7\u767b\u5f55"}),n.router.navigateByUrl("/auth/signin")):a.F.fire({icon:"error",titleText:JSON.stringify(o.err)})})):a.F.fire({icon:"error",titleText:"\u8054\u7cfb\u7535\u8bdd\u683c\u5f0f\u9519\u8bef"}):a.F.fire({icon:"error",titleText:"\u4e24\u6b21\u5bc6\u7801\u8f93\u5165\u4e0d\u4e00\u81f4"}):a.F.fire({icon:"error",titleText:"\u5bc6\u7801\u683c\u5f0f\u9519\u8bef"}):a.F.fire({icon:"error",titleText:"\u90ae\u7bb1\u683c\u5f0f\u9519\u8bef"})})()}}return t.\u0275fac=function(n){return new(n||t)(e.Y36(U.K),e.Y36(u.t2),e.Y36(_.F0))},t.\u0275cmp=e.Xpm({type:t,selectors:[["app-signup"]],decls:32,vars:6,consts:function(){let s,n,i,o,r,c,A;return s=$localize`:@@注册:注册`,n=$localize`:@@返回首页:返回首页`,i=$localize`:@@邮箱:邮箱`,o=$localize`:@@密码:密码`,r=$localize`:@@确认密码:确认密码`,c=$localize`:@@手机号:手机号`,A=$localize`:@@注册:注册`,[[1,"container-fluid"],[1,"row"],[1,"col-sm-12","col-md-4","offset-md-4","d-flex","align-items-start","justify-content-center",2,"height","100vh"],[1,"mt-5",2,"width","80%"],[1,"card"],[1,"card-header","d-flex"],["translate","",1,"w-100"],s,["translate","","matRipple","",1,"btn","btn-link","mx-2",3,"routerLink"],n,[1,"card-body"],[1,"mb-3"],["translate","",1,"form-label"],i,["type","email",1,"form-control",3,"ngModel","ngModelChange"],o,["type","password",1,"form-control",3,"ngModel","ngModelChange"],r,c,["type","text",1,"form-control",3,"ngModel","ngModelChange"],["type","button","matRipple","","translate","",1,"btn","btn-success",3,"click"],A,["size","default","color","#fff","type","ball-beat"]]},template:function(n,i){1&n&&(e.TgZ(0,"div",0),e.TgZ(1,"div",1),e.TgZ(2,"div",2),e.TgZ(3,"div",3),e.TgZ(4,"div",4),e.TgZ(5,"div",5),e.TgZ(6,"h3",6),e.SDv(7,7),e.qZA(),e.TgZ(8,"div"),e.TgZ(9,"a",8),e.SDv(10,9),e.qZA(),e.qZA(),e.qZA(),e.TgZ(11,"div",10),e.TgZ(12,"div",11),e.TgZ(13,"label",12),e.SDv(14,13),e.qZA(),e.TgZ(15,"input",14),e.NdJ("ngModelChange",function(r){return i.item.email=r}),e.qZA(),e.qZA(),e.TgZ(16,"div",11),e.TgZ(17,"label",12),e.SDv(18,15),e.qZA(),e.TgZ(19,"input",16),e.NdJ("ngModelChange",function(r){return i.item.pwd=r}),e.qZA(),e.qZA(),e.TgZ(20,"div",11),e.TgZ(21,"label",12),e.SDv(22,17),e.qZA(),e.TgZ(23,"input",16),e.NdJ("ngModelChange",function(r){return i.pwd2=r}),e.qZA(),e.qZA(),e.TgZ(24,"div",11),e.TgZ(25,"label",12),e.SDv(26,18),e.qZA(),e.TgZ(27,"input",19),e.NdJ("ngModelChange",function(r){return i.item.phone=r}),e.qZA(),e.qZA(),e.TgZ(28,"div",11),e.TgZ(29,"button",20),e.NdJ("click",function(){return i.signin()}),e.SDv(30,21),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e._UZ(31,"ngx-spinner",22)),2&n&&(e.xp6(9),e.Q6J("routerLink",e.DdM(5,Z)),e.xp6(6),e.Q6J("ngModel",i.item.email),e.xp6(4),e.Q6J("ngModel",i.item.pwd),e.xp6(4),e.Q6J("ngModel",i.pwd2),e.xp6(4),e.Q6J("ngModel",i.item.phone))},directives:[S.Pi,_.yS,E.wG,p.Fj,p.JJ,p.On,u.Ro],styles:[""]}),t})()},{path:"signin-callback",component:h}];let I=(()=>{class t{}return t.\u0275fac=function(n){return new(n||t)},t.\u0275mod=e.oAB({type:t}),t.\u0275inj=e.cJS({imports:[[_.Bz.forChild(v)],_.Bz]}),t})();var O=l(1382),G=l(7623),y=l(4522);function N(t){return new G.w(t,d.N.i18n_asset_prefix)}let $=(()=>{class t{}return t.\u0275fac=function(n){return new(n||t)},t.\u0275mod=e.oAB({type:t}),t.\u0275inj=e.cJS({imports:[[O.m,M.ez,p.u5,I,u.ef,S.aw.forChild({loader:{provide:S.Zw,useFactory:N,deps:[y.eN]},isolate:!1,extend:!0})]]}),t})()}}]);